
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../dataloaders/">
      
      
        <link rel="next" href="../reference_dataset_config/">
      
      
      <link rel="icon" href="../images/datazoo_logo.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>CesnetDataset - CESNET DataZoo</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-788ETHG59K"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-788ETHG59K",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-788ETHG59K",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#base-dataset-class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CESNET DataZoo" class="md-header__button md-logo" aria-label="CESNET DataZoo" data-md-component="logo">
      
  <img src="../images/datazoo_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CESNET DataZoo
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CesnetDataset
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/CESNET/cesnet-datazoo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    CESNET/cesnet-datazoo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CESNET DataZoo" class="md-nav__button md-logo" aria-label="CESNET DataZoo" data-md-component="logo">
      
  <img src="../images/datazoo_logo.svg" alt="logo">

    </a>
    CESNET DataZoo
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CESNET/cesnet-datazoo" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    CESNET/cesnet-datazoo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../datasets_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oveview of datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data features
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../transforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transforms
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dataloaders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using dataloaders
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CesnetDataset
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CesnetDataset
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset" class="md-nav__link">
    CesnetDataset
  </a>
  
    <nav class="md-nav" aria-label="CesnetDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.set_dataset_config_and_initialize" class="md-nav__link">
    set_dataset_config_and_initialize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_train_dataloader" class="md-nav__link">
    get_train_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_val_dataloader" class="md-nav__link">
    get_val_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_test_dataloader" class="md-nav__link">
    get_test_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_dataloaders" class="md-nav__link">
    get_dataloaders()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_train_df" class="md-nav__link">
    get_train_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_val_df" class="md-nav__link">
    get_val_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_test_df" class="md-nav__link">
    get_test_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_num_classes" class="md-nav__link">
    get_num_classes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_known_apps" class="md-nav__link">
    get_known_apps()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_unknown_apps" class="md-nav__link">
    get_unknown_apps()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.compute_dataset_statistics" class="md-nav__link">
    compute_dataset_statistics()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../reference_dataset_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DatasetConfig
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../reference_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DatasetMetadata
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset" class="md-nav__link">
    CesnetDataset
  </a>
  
    <nav class="md-nav" aria-label="CesnetDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.set_dataset_config_and_initialize" class="md-nav__link">
    set_dataset_config_and_initialize()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_train_dataloader" class="md-nav__link">
    get_train_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_val_dataloader" class="md-nav__link">
    get_val_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_test_dataloader" class="md-nav__link">
    get_test_dataloader()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_dataloaders" class="md-nav__link">
    get_dataloaders()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_train_df" class="md-nav__link">
    get_train_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_val_df" class="md-nav__link">
    get_val_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_test_df" class="md-nav__link">
    get_test_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_num_classes" class="md-nav__link">
    get_num_classes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_known_apps" class="md-nav__link">
    get_known_apps()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.get_unknown_apps" class="md-nav__link">
    get_unknown_apps()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datasets.cesnet_dataset.CesnetDataset.compute_dataset_statistics" class="md-nav__link">
    compute_dataset_statistics()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="base-dataset-class">Base dataset class</h1>


<div class="doc doc-object doc-class">




<h2 id="datasets.cesnet_dataset.CesnetDataset" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">datasets.cesnet_dataset.CesnetDataset</span>


</h2>


  <div class="doc doc-contents first">

  
      <p>The main class for accessing CESNET datasets. It handles downloading, train/validation/test splitting, and class selection. Access to data is provided through:</p>
<ul>
<li>Iterable PyTorch DataLoader for batch processing. See <a class="autorefs autorefs-internal" href="../dataloaders/#using-dataloaders">using dataloaders</a> for more details.</li>
<li>Pandas DataFrame for loading the entire train, validation, or test set at once.</li>
</ul>
<p>The dataset is stored in a <a href="https://www.pytables.org/">PyTables</a> database. The internal <code>PyTablesDataset</code> class is used as a wrapper
that implements the PyTorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset"><code>Dataset</code></a> interface
and is compatible with <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>,
which provides efficient parallel loading of the data. The dataset configuration is done through the <a class="autorefs autorefs-internal" href="../reference_dataset_config/#config.DatasetConfig"><code>DatasetConfig</code></a> class.</p>
<p><strong>Intended usage:</strong></p>
<ol>
<li>Create an instance of the <a class="autorefs autorefs-internal" href="../reference_datasets/#dataset-classes">dataset class</a> with the desired size and data root. This will download the dataset if it has not already been downloaded.</li>
<li>Create an instance of <a class="autorefs autorefs-internal" href="../reference_dataset_config/#config.DatasetConfig"><code>DatasetConfig</code></a> and set it with <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.set_dataset_config_and_initialize"><code>set_dataset_config_and_initialize</code></a>.
This will initialize the dataset â€” select classes, split data into train/validation/test sets, and fit data scalers if needed. All is done according to the provided configuration and is cached for later use.</li>
<li>Use <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.get_train_dataloader"><code>get_train_dataloader</code></a> or <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.get_train_df"><code>get_train_df</code></a> to get training data for a classification model.</li>
<li>Validate the model and perform the hyperparameter optimalization on <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.get_val_dataloader"><code>get_val_dataloader</code></a> or <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.get_val_df"><code>get_val_df</code></a>.</li>
<li>Evaluate the model on <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.get_test_dataloader"><code>get_test_dataloader</code></a> or <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.get_test_df"><code>get_test_df</code></a>.</li>
</ol>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_root</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the folder where the dataset will be stored. Each dataset size has its own subfolder <code>data_root/size</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>size</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the dataset. Options are <code>XS</code>, <code>S</code>, <code>M</code>, <code>L</code>, <code>ORIG</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;S&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>silent</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to suppress print and tqdm output.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the dataset.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>database_filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the database file.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>database_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the database file.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>servicemap_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the servicemap file.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>statistics_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the dataset statistics folder.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>bucket_url</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>URL of the bucket where the database is stored.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>metadata</code></td>
          <td>
                <code><span title="cesnet_datazoo.datasets.metadata.dataset_metadata.DatasetMetadata">DatasetMetadata</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional <a class="autorefs autorefs-internal" href="../dataset_metadata/#metadata">dataset metadata</a>.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>available_classes</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of all available classes in the dataset.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>available_dates</code></td>
          <td>
                <code>list[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of all available dates in the dataset.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>time_periods</code></td>
          <td>
                <code>dict[str, list[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Predefined time periods. Each time period is a list of dates.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>default_train_period_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default time period for training.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>default_test_period_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default time period for testing.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>The following attributes are initialized when <a class="autorefs autorefs-internal" href="#datasets.cesnet_dataset.CesnetDataset.set_dataset_config_and_initialize"><code>set_dataset_config_and_initialize</code></a> is called.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dataset_config</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="cesnet_datazoo.config.DatasetConfig">DatasetConfig</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration of the dataset.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>class_info</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="cesnet_datazoo.utils.class_info.ClassInfo">ClassInfo</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Structured information about the classes.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>dataset_indices</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="cesnet_datazoo.pytables_data.indices_setup.IndicesTuple">IndicesTuple</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Named tuple containing <code>train_indices</code>, <code>val_known_indices</code>, <code>val_unknown_indices</code>, <code>test_known_indices</code>, <code>test_unknown_indices</code>. These are the indices into PyTables database that define train, validation, and test sets.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>train_dataset</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="cesnet_datazoo.pytables_data.pytables_dataset.PyTablesDataset">PyTablesDataset</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Train set in the form of <code>PyTablesDataset</code> instance wrapping the PyTables database.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>val_dataset</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="cesnet_datazoo.pytables_data.pytables_dataset.PyTablesDataset">PyTablesDataset</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Validation set in the form of <code>PyTablesDataset</code> instance wrapping the PyTables database.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>test_dataset</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="cesnet_datazoo.pytables_data.pytables_dataset.PyTablesDataset">PyTablesDataset</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Test set in the form of <code>PyTablesDataset</code> instance wrapping the PyTables database.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>known_app_counts</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Known application counts in the train, validation, and test sets.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>unknown_app_counts</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Unknown application counts in the validation and test sets.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>train_dataloader</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="torch.utils.data.DataLoader">DataLoader</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable PyTorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> for training.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>train_dataloader_sampler</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="torch.utils.data.Sampler">Sampler</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sampler used for iterating the training dataloader. Either <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.RandomSampler"><code>RandomSampler</code></a> or <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.SequentialSampler"><code>SequentialSampler</code></a>.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>train_dataloader_drop_last</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to drop the last incomplete batch when iterating the training dataloader.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>val_dataloader</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="torch.utils.data.DataLoader">DataLoader</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable PyTorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> for validation.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>test_dataloader</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="torch.utils.data.DataLoader">DataLoader</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable PyTorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> for testing.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CesnetDataset</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The main class for accessing CESNET datasets. It handles downloading, train/validation/test splitting, and class selection. Access to data is provided through:</span>

<span class="sd">    - Iterable PyTorch DataLoader for batch processing. See [using dataloaders][using-dataloaders] for more details.</span>
<span class="sd">    - Pandas DataFrame for loading the entire train, validation, or test set at once.</span>

<span class="sd">    The dataset is stored in a [PyTables](https://www.pytables.org/) database. The internal `PyTablesDataset` class is used as a wrapper</span>
<span class="sd">    that implements the PyTorch [`Dataset`](https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset) interface</span>
<span class="sd">    and is compatible with [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader),</span>
<span class="sd">    which provides efficient parallel loading of the data. The dataset configuration is done through the [`DatasetConfig`][config.DatasetConfig] class.</span>

<span class="sd">    **Intended usage:**</span>

<span class="sd">    1. Create an instance of the [dataset class][dataset-classes] with the desired size and data root. This will download the dataset if it has not already been downloaded.</span>
<span class="sd">    2. Create an instance of [`DatasetConfig`][config.DatasetConfig] and set it with [`set_dataset_config_and_initialize`][datasets.cesnet_dataset.CesnetDataset.set_dataset_config_and_initialize].</span>
<span class="sd">    This will initialize the dataset â€” select classes, split data into train/validation/test sets, and fit data scalers if needed. All is done according to the provided configuration and is cached for later use.</span>
<span class="sd">    3. Use [`get_train_dataloader`][datasets.cesnet_dataset.CesnetDataset.get_train_dataloader] or [`get_train_df`][datasets.cesnet_dataset.CesnetDataset.get_train_df] to get training data for a classification model.</span>
<span class="sd">    4. Validate the model and perform the hyperparameter optimalization on [`get_val_dataloader`][datasets.cesnet_dataset.CesnetDataset.get_val_dataloader] or [`get_val_df`][datasets.cesnet_dataset.CesnetDataset.get_val_df].</span>
<span class="sd">    5. Evaluate the model on [`get_test_dataloader`][datasets.cesnet_dataset.CesnetDataset.get_test_dataloader] or [`get_test_df`][datasets.cesnet_dataset.CesnetDataset.get_test_df].</span>

<span class="sd">    Parameters:</span>
<span class="sd">        data_root: Path to the folder where the dataset will be stored. Each dataset size has its own subfolder `data_root/size`</span>
<span class="sd">        size: Size of the dataset. Options are `XS`, `S`, `M`, `L`, `ORIG`.</span>
<span class="sd">        silent: Whether to suppress print and tqdm output.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name: Name of the dataset.</span>
<span class="sd">        database_filename: Name of the database file.</span>
<span class="sd">        database_path: Path to the database file.</span>
<span class="sd">        servicemap_path: Path to the servicemap file.</span>
<span class="sd">        statistics_path: Path to the dataset statistics folder.</span>
<span class="sd">        bucket_url: URL of the bucket where the database is stored.</span>
<span class="sd">        metadata: Additional [dataset metadata][metadata].</span>
<span class="sd">        available_classes: List of all available classes in the dataset.</span>
<span class="sd">        available_dates: List of all available dates in the dataset.</span>
<span class="sd">        time_periods: Predefined time periods. Each time period is a list of dates.</span>
<span class="sd">        default_train_period_name: Default time period for training.</span>
<span class="sd">        default_test_period_name: Default time period for testing.</span>

<span class="sd">    The following attributes are initialized when [`set_dataset_config_and_initialize`][datasets.cesnet_dataset.CesnetDataset.set_dataset_config_and_initialize] is called.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dataset_config: Configuration of the dataset.</span>
<span class="sd">        class_info: Structured information about the classes.</span>
<span class="sd">        dataset_indices: Named tuple containing `train_indices`, `val_known_indices`, `val_unknown_indices`, `test_known_indices`, `test_unknown_indices`. These are the indices into PyTables database that define train, validation, and test sets.</span>
<span class="sd">        train_dataset: Train set in the form of `PyTablesDataset` instance wrapping the PyTables database.</span>
<span class="sd">        val_dataset: Validation set in the form of `PyTablesDataset` instance wrapping the PyTables database.</span>
<span class="sd">        test_dataset: Test set in the form of `PyTablesDataset` instance wrapping the PyTables database.</span>
<span class="sd">        known_app_counts: Known application counts in the train, validation, and test sets.</span>
<span class="sd">        unknown_app_counts: Unknown application counts in the validation and test sets.</span>
<span class="sd">        train_dataloader: Iterable PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for training.</span>
<span class="sd">        train_dataloader_sampler: Sampler used for iterating the training dataloader. Either [`RandomSampler`](https://pytorch.org/docs/stable/data.html#torch.utils.data.RandomSampler) or [`SequentialSampler`](https://pytorch.org/docs/stable/data.html#torch.utils.data.SequentialSampler).</span>
<span class="sd">        train_dataloader_drop_last: Whether to drop the last incomplete batch when iterating the training dataloader.</span>
<span class="sd">        val_dataloader: Iterable PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for validation.</span>
<span class="sd">        test_dataloader: Iterable PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for testing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_root</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">silent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">database_filename</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">database_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">servicemap_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">statistics_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">bucket_url</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">DatasetMetadata</span>
    <span class="n">available_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">available_dates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">time_periods</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">default_train_period_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">default_test_period_name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DatasetConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">class_info</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ClassInfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dataset_indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IndicesTuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">train_dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PyTablesDataset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">val_dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PyTablesDataset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">test_dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PyTablesDataset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">known_app_counts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">unknown_app_counts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataLoader</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">train_dataloader_sampler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sampler</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">train_dataloader_drop_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataLoader</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataLoader</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_collate_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_tables_app_enum</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">_tables_cat_enum</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_root</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="n">database_checks_at_init</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">silent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">silent</span> <span class="o">=</span> <span class="n">silent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">load_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="s2">&quot;ORIG&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">size</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">available_dataset_sizes</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown dataset size </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">filename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database_filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">database_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database_filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">servicemap_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">,</span> <span class="n">SERVICEMAP_FILE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statistics_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">,</span> <span class="s2">&quot;statistics&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_root</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_downloaded</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">database_checks_at_init</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">tb</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">database</span><span class="p">:</span>
                <span class="n">tables_paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">_v_pathname</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/flows&quot;</span><span class="p">))))</span>
                <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tables_paths</span><span class="p">:</span>
                    <span class="n">table</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">tb</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span> <span class="o">!=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">get_enum</span><span class="p">(</span><span class="n">APP_COLUMN</span><span class="p">))</span><span class="o">.</span><span class="n">items</span><span class="p">()}:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found mismatch between _tables_app_enum and the PyTables database enum in table </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">. Please report this issue.&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tables_cat_enum</span> <span class="o">!=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">get_enum</span><span class="p">(</span><span class="n">CATEGORY_COLUMN</span><span class="p">))</span><span class="o">.</span><span class="n">items</span><span class="p">()}:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found mismatch between _tables_cat_enum and the PyTables database enum in table </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">. Please report this issue.&quot;</span><span class="p">)</span>
                    <span class="n">num_samples</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="s2">&quot;ORIG&quot;</span> <span class="ow">and</span> <span class="n">num_samples</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">available_samples</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">available_samples</span><span class="si">}</span><span class="s2"> samples, but got </span><span class="si">{</span><span class="n">num_samples</span><span class="si">}</span><span class="s2"> in the database. Please delete the data root folder, update cesnet-datazoo, and redownload the dataset.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="s2">&quot;ORIG&quot;</span> <span class="ow">and</span> <span class="n">num_samples</span> <span class="o">!=</span> <span class="n">DATASET_SIZES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">DATASET_SIZES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">]</span><span class="si">}</span><span class="s2"> samples, but got </span><span class="si">{</span><span class="n">num_samples</span><span class="si">}</span><span class="s2"> in the database. Please delete the data root folder, update cesnet-datazoo, and redownload the dataset.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_dates</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">removeprefix</span><span class="p">(</span><span class="s2">&quot;/flows/D&quot;</span><span class="p">),</span> <span class="n">tables_paths</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found mismatch between available_dates and the dates available in the PyTables database. Please report this issue.&quot;</span><span class="p">)</span>
        <span class="c1"># Add all available dates as single date time periods</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_dates</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_periods</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span>
        <span class="n">available_applications</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">app</span> <span class="k">for</span> <span class="n">app</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servicemap_path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Tag&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_background_app</span><span class="p">(</span><span class="n">app</span><span class="p">)])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available_applications</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">application_count</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">available_applications</span><span class="p">)</span><span class="si">}</span><span class="s2"> applications in the servicemap (omitting background traffic classes), but expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">application_count</span><span class="si">}</span><span class="s2">. Please report this issue.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">available_classes</span> <span class="o">=</span> <span class="n">available_applications</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">background_traffic_classes</span>

    <span class="k">def</span> <span class="nf">set_dataset_config_and_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span> <span class="n">disable_indices_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize train, validation, and test sets. Data cannot be accessed before calling this method.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            dataset_config: Desired configuration of the dataset.</span>
<span class="sd">            disable_indices_cache: Whether to disable caching of the dataset indices. This is useful when the dataset is used in many different configurations and you want to save disk space.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="o">=</span> <span class="n">dataset_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_train_val_test</span><span class="p">(</span><span class="n">disable_indices_cache</span><span class="o">=</span><span class="n">disable_indices_cache</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_train_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for training. The dataloader is created on the first call and then cached.</span>
<span class="sd">        When the dataloader is iterated in random order, the last incomplete batch is dropped.</span>
<span class="sd">        The dataloader is configured with the following config attributes:</span>

<span class="sd">        | Dataset config               | Description                                                                                |</span>
<span class="sd">        | ---------------------------- | ------------------------------------------------------------------------------------------ |</span>
<span class="sd">        | `batch_size`                 | Number of samples per batch.                                                               |</span>
<span class="sd">        | `train_workers`              | Number of workers for loading train data.                                                  |</span>
<span class="sd">        | `train_dataloader_order`     | Whether to load train data in sequential or random order. See [config.DataLoaderOrder][].  |</span>
<span class="sd">        | `train_dataloader_seed`      | Seed for loading train data in random order.                                               |</span>

<span class="sd">        Returns:</span>
<span class="sd">            Train data as an iterable dataloader. See [using dataloaders][using-dataloaders] for more details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting train dataloader&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_train_set</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Train dataloader is not available when need_train_set is false&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span>
        <span class="c1"># Create sampler according to the selected order</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_order</span> <span class="o">==</span> <span class="n">DataLoaderOrder</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">generator</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">()</span>
                <span class="n">generator</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_seed</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span> <span class="o">=</span> <span class="n">RandomSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="n">generator</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_order</span> <span class="o">==</span> <span class="n">DataLoaderOrder</span><span class="o">.</span><span class="n">SEQUENTIAL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span> <span class="o">=</span> <span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">assert_never</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_order</span><span class="p">)</span>
        <span class="c1"># Create dataloader</span>
        <span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">BatchSampler</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span><span class="p">)</span>
        <span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">,</span>
            <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_workers</span><span class="p">,</span>
            <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_fn</span><span class="p">,</span>
            <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span><span class="p">,</span>
            <span class="n">persistent_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_workers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">batch_sampler</span><span class="p">,)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">pytables_worker_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">train_dataloader</span>
        <span class="k">return</span> <span class="n">train_dataloader</span>

    <span class="k">def</span> <span class="nf">get_val_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for validation.</span>
<span class="sd">        The dataloader is created on the first call and then cached.</span>
<span class="sd">        The dataloader is configured with the following config attributes:</span>

<span class="sd">        | Dataset config    | Description                                                       |</span>
<span class="sd">        | ------------------| ------------------------------------------------------------------|</span>
<span class="sd">        | `test_batch_size` | Number of samples per batch for loading validation and test data. |</span>
<span class="sd">        | `val_workers`     | Number of workers for loading validation data.                    |</span>

<span class="sd">        Returns:</span>
<span class="sd">            Validation data as an iterable dataloader. See [using dataloaders][using-dataloaders] for more details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting validaion dataloader&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_val_set</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Validation dataloader is not available when need_val_set is false&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span>
        <span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">BatchSampler</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_batch_size</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">,</span>
            <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_workers</span><span class="p">,</span>
            <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_fn</span><span class="p">,</span>
            <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span><span class="p">,</span>
            <span class="n">persistent_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_workers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">batch_sampler</span><span class="p">,)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="o">.</span><span class="n">pytables_worker_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">val_dataloader</span>
        <span class="k">return</span> <span class="n">val_dataloader</span>

    <span class="k">def</span> <span class="nf">get_test_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provides a PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for testing.</span>
<span class="sd">        The dataloader is created on the first call and then cached.</span>

<span class="sd">        When the dataset is used in the open-world setting, and unknown classes are defined,</span>
<span class="sd">        the test dataloader returns `test_known_size` samples of known classes followed by `test_unknown_size` samples of unknown classes.</span>

<span class="sd">        The dataloader is configured with the following config attributes:</span>

<span class="sd">        | Dataset config    | Description                                                       |</span>
<span class="sd">        | ------------------| ------------------------------------------------------------------|</span>
<span class="sd">        | `test_batch_size` | Number of samples per batch for loading validation and test data. |</span>
<span class="sd">        | `test_workers`    | Number of workers for loading test data.                          |</span>

<span class="sd">        Returns:</span>
<span class="sd">            Test data as an iterable dataloader. See [using dataloaders][using-dataloaders] for more details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting test dataloader&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_test_set</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Test dataloader is not available when need_test_set is false&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span>
        <span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">BatchSampler</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_batch_size</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">,</span>
            <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_workers</span><span class="p">,</span>
            <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_fn</span><span class="p">,</span>
            <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span><span class="p">,</span>
            <span class="n">persistent_workers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">batch_sampler</span><span class="p">,)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="o">.</span><span class="n">pytables_worker_init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">test_dataloader</span>
        <span class="k">return</span> <span class="n">test_dataloader</span>

    <span class="k">def</span> <span class="nf">get_dataloaders</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">DataLoader</span><span class="p">,</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">DataLoader</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets train, validation, and test dataloaders in one call.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting dataloaders&quot;</span><span class="p">)</span>
        <span class="n">train_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_train_dataloader</span><span class="p">()</span>
        <span class="n">val_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_val_dataloader</span><span class="p">()</span>
        <span class="n">test_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_test_dataloader</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">train_dataloader</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="p">,</span> <span class="n">test_dataloader</span>

    <span class="k">def</span> <span class="nf">get_train_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a train Pandas [`DataFrame`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html). The dataframe is in sequential (datetime) order. Consider shuffling the dataframe if needed.</span>

<span class="sd">        !!! warning &quot;Memory usage&quot;</span>

<span class="sd">            The whole train set is loaded into memory. If the dataset size is larger than `&#39;S&#39;`, consider using `get_train_dataloader` instead.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            flatten_ppi: Whether to flatten the PPI sequence into individual columns (named `IPT_X`, `DIR_X`, `SIZE_X`, `PUSH_X`, *X* being the index of the packet) or keep one `PPI` column with 2D data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Train data as a dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_before_dataframe</span><span class="p">(</span><span class="n">check_train</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DATAFRAME_SAMPLES_WARNING_THRESHOLD</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train set has (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples), consider using get_train_dataloader() instead&quot;</span><span class="p">)</span>
        <span class="n">train_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_train_dataloader</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="p">,</span> <span class="n">BatchSampler</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="c1"># Read dataloader in sequential order</span>
        <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sampler</span> <span class="o">=</span> <span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span>
        <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">drop_last</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">create_df_from_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
                                       <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
                                       <span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">,</span>
                                       <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>
        <span class="c1"># Restore the original dataloader sampler and drop_last</span>
        <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sampler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span>
        <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">drop_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">get_val_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates validation Pandas [`DataFrame`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html). The dataframe is in sequential (datetime) order.</span>

<span class="sd">        !!! warning &quot;Memory usage&quot;</span>

<span class="sd">            The whole validation set is loaded into memory. If the dataset size is larger than `&#39;S&#39;`, consider using `get_val_dataloader` instead.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            flatten_ppi: Whether to flatten the PPI sequence into individual columns (named `IPT_X`, `DIR_X`, `SIZE_X`, `PUSH_X`, *X* being the index of the packet) or keep one `PPI` column with 2D data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Validation data as a dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_before_dataframe</span><span class="p">(</span><span class="n">check_val</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DATAFRAME_SAMPLES_WARNING_THRESHOLD</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation set has (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples), consider using get_val_dataloader() instead&quot;</span><span class="p">)</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">create_df_from_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_val_dataloader</span><span class="p">(),</span>
                                         <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
                                         <span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">,</span>
                                         <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_test_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates test Pandas [`DataFrame`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html). The dataframe is in sequential (datetime) order.</span>


<span class="sd">        When the dataset is used in the open-world setting, and unknown classes are defined,</span>
<span class="sd">        the returned test dataframe is composed of `test_known_size` samples of known classes followed by `test_unknown_size` samples of unknown classes.</span>


<span class="sd">        !!! warning &quot;Memory usage&quot;</span>

<span class="sd">            The whole test set is loaded into memory. If the dataset size is larger than `&#39;S&#39;`, consider using `get_test_dataloader` instead.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            flatten_ppi: Whether to flatten the PPI sequence into individual columns (named `IPT_X`, `DIR_X`, `SIZE_X`, `PUSH_X`, *X* being the index of the packet) or keep one `PPI` column with 2D data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Test data as a dataframe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_before_dataframe</span><span class="p">(</span><span class="n">check_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DATAFRAME_SAMPLES_WARNING_THRESHOLD</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test set has (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples), consider using get_test_dataloader() instead&quot;</span><span class="p">)</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">create_df_from_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_test_dataloader</span><span class="p">(),</span>
                                         <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
                                         <span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">,</span>
                                         <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_num_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of classes in the current configuration of the dataset.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting the number of classes&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span><span class="o">.</span><span class="n">num_classes</span>

    <span class="k">def</span> <span class="nf">get_known_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the list of known applications in the current configuration of the dataset.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting known apps&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span><span class="o">.</span><span class="n">known_apps</span>

    <span class="k">def</span> <span class="nf">get_unknown_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the list of unknown applications in the current configuration of the dataset.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting unknown apps&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span><span class="o">.</span><span class="n">unknown_apps</span>

    <span class="k">def</span> <span class="nf">compute_dataset_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10_000_000</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16384</span><span class="p">,</span> <span class="n">disabled_apps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes dataset statistics and saves them to the `statistics_path` folder.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            num_samples: Number of samples to use for computing the statistics.</span>
<span class="sd">            num_workers: Number of workers for loading data.</span>
<span class="sd">            batch_size: Number of samples per batch for loading data.</span>
<span class="sd">            disabled_apps: List of applications to exclude from the statistics.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">disabled_apps</span><span class="p">:</span>
            <span class="n">bad_disabled_apps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">disabled_apps</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_classes</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bad_disabled_apps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad applications in disabled_apps </span><span class="si">{</span><span class="n">bad_disabled_apps</span><span class="si">}</span><span class="s2">. Use applications available in dataset.available_classes&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">statistics_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">statistics_path</span><span class="p">)</span>
        <span class="n">compute_dataset_statistics</span><span class="p">(</span><span class="n">database_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">database_path</span><span class="p">,</span>
                                   <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                                   <span class="n">tables_cat_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_cat_enum</span><span class="p">,</span>
                                   <span class="n">output_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">statistics_path</span><span class="p">,</span>
                                   <span class="n">packet_histograms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">packet_histograms</span><span class="p">,</span>
                                   <span class="n">flowstats_features_boolean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">flowstats_features_boolean</span><span class="p">,</span>
                                   <span class="n">protocol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">protocol</span><span class="p">,</span>
                                   <span class="n">extra_fields</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;CESNET-TLS22&quot;</span><span class="p">),</span>
                                   <span class="n">disabled_apps</span><span class="o">=</span><span class="n">disabled_apps</span> <span class="k">if</span> <span class="n">disabled_apps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
                                   <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
                                   <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                                   <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                                   <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generate_time_periods</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_periods</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_periods</span><span class="p">:</span>
            <span class="n">time_periods</span><span class="p">[</span><span class="n">period</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">period</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">):</span>
                <span class="n">split</span> <span class="o">=</span> <span class="n">period</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
                <span class="n">collection_year</span><span class="p">,</span> <span class="n">week</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">fromisocalendar</span><span class="p">(</span><span class="n">collection_year</span><span class="p">,</span> <span class="n">week</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="c1"># last week of a year can span into the following year</span>
                    <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">missing_dates_in_collection_period</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">collection_year</span><span class="p">)):</span>
                        <span class="n">time_periods</span><span class="p">[</span><span class="n">period</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">period</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">):</span>
                <span class="n">split</span> <span class="o">=</span> <span class="n">period</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
                <span class="n">collection_year</span><span class="p">,</span> <span class="n">month</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="n">collection_year</span><span class="p">,</span> <span class="n">month</span><span class="p">)[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">collection_year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">missing_dates_in_collection_period</span><span class="p">:</span>
                        <span class="n">time_periods</span><span class="p">[</span><span class="n">period</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_periods</span> <span class="o">=</span> <span class="n">time_periods</span>

    <span class="k">def</span> <span class="nf">_is_downloaded</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Servicemap is downloaded after the database; thus if it exists, the database is also downloaded&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">servicemap_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_download</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> dataset&quot;</span><span class="p">)</span>
        <span class="n">database_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_url</span><span class="si">}</span><span class="s2">&amp;file=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">database_filename</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">servicemap_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bucket_url</span><span class="si">}</span><span class="s2">&amp;file=</span><span class="si">{</span><span class="n">SERVICEMAP_FILE</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">resumable_download</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">database_url</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">database_path</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>
        <span class="n">simple_download</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">servicemap_url</span><span class="p">,</span> <span class="n">file_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">servicemap_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_indices</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known_app_counts</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown_app_counts</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_check_before_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_train</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">check_val</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">check_test</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting a dataframe&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">return_tensors</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataframes are not available when return_tensors is set. Use a dataloader instead.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_train</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_train_set</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Train dataframe is not available when need_train_set is false&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_val</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_val_set</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Validation dataframe is not available when need_val_set is false&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check_test</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_test_set</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Test dataframe is not available when need_test_set is false&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initialize_train_val_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">disable_indices_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">dataset_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span>
        <span class="n">servicemap</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">servicemap_path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Tag&quot;</span><span class="p">)</span>
        <span class="c1"># Initialize train set</span>
        <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">need_train_set</span><span class="p">:</span>
            <span class="n">train_indices</span><span class="p">,</span> <span class="n">train_unknown_indices</span><span class="p">,</span> <span class="n">known_apps</span><span class="p">,</span> <span class="n">unknown_apps</span> <span class="o">=</span> <span class="n">init_or_load_train_indices</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">,</span>
                                                                                                        <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                                                                                                        <span class="n">servicemap</span><span class="o">=</span><span class="n">servicemap</span><span class="p">,</span>
                                                                                                        <span class="n">disable_indices_cache</span><span class="o">=</span><span class="n">disable_indices_cache</span><span class="p">,)</span>
            <span class="c1"># Date weight sampling of train indices</span>
            <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dates_weigths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span>
                <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_approach</span> <span class="o">==</span> <span class="n">ValidationApproach</span><span class="o">.</span><span class="n">SPLIT_FROM_TRAIN</span><span class="p">:</span>
                    <span class="c1"># requested number of samples is train_size + val_known_size when using the split-from-train validation approach</span>
                    <span class="k">assert</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span>
                    <span class="n">num_samples</span> <span class="o">=</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">num_samples</span> <span class="o">=</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span>
                <span class="k">if</span> <span class="n">num_samples</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested number of samples for weight sampling (</span><span class="si">{</span><span class="n">num_samples</span><span class="si">}</span><span class="s2">) is larger than the number of available train samples (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="n">train_indices</span> <span class="o">=</span> <span class="n">date_weight_sample_train_indices</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">,</span> <span class="n">train_indices</span><span class="o">=</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">apps_selection</span> <span class="o">==</span> <span class="n">AppSelection</span><span class="o">.</span><span class="n">FIXED</span><span class="p">:</span>
            <span class="n">known_apps</span> <span class="o">=</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">apps_selection_fixed_known</span>
            <span class="n">unknown_apps</span> <span class="o">=</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">apps_selection_fixed_unknown</span>
            <span class="n">train_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="n">train_unknown_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either need train set or the fixed application selection&quot;</span><span class="p">)</span>
        <span class="c1"># Initialize validation set</span>
        <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">need_val_set</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_approach</span> <span class="o">==</span> <span class="n">ValidationApproach</span><span class="o">.</span><span class="n">VALIDATION_DATES</span><span class="p">:</span>
                <span class="n">val_known_indices</span><span class="p">,</span> <span class="n">val_unknown_indices</span><span class="p">,</span> <span class="n">val_data_path</span> <span class="o">=</span> <span class="n">init_or_load_val_indices</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">,</span>
                                                                                                 <span class="n">known_apps</span><span class="o">=</span><span class="n">known_apps</span><span class="p">,</span>
                                                                                                 <span class="n">unknown_apps</span><span class="o">=</span><span class="n">unknown_apps</span><span class="p">,</span>
                                                                                                 <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                                                                                                 <span class="n">disable_indices_cache</span><span class="o">=</span><span class="n">disable_indices_cache</span><span class="p">,)</span>
            <span class="k">elif</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_approach</span> <span class="o">==</span> <span class="n">ValidationApproach</span><span class="o">.</span><span class="n">SPLIT_FROM_TRAIN</span><span class="p">:</span>
                <span class="n">train_val_rng</span> <span class="o">=</span> <span class="n">get_fresh_random_generator</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="n">RandomizedSection</span><span class="o">.</span><span class="n">TRAIN_VAL_SPLIT</span><span class="p">)</span>
                <span class="n">val_data_path</span> <span class="o">=</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">_get_train_data_path</span><span class="p">()</span>
                <span class="n">val_unknown_indices</span> <span class="o">=</span> <span class="n">train_unknown_indices</span>
                <span class="n">train_labels</span> <span class="o">=</span> <span class="n">train_indices</span><span class="p">[:,</span> <span class="n">INDICES_LABEL_POS</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dates_weigths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span>
                    <span class="c1"># When weight sampling is used, val_known_size is kept but the resulting train size can be smaller due to no enough samples in some train dates</span>
                    <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested validation size (</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span><span class="si">}</span><span class="s2">) is larger than the number of available train samples after weight sampling (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                    <span class="n">train_indices</span><span class="p">,</span> <span class="n">val_known_indices</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">train_labels</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">train_val_rng</span><span class="p">)</span>
                    <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                    <span class="n">train_indices</span><span class="p">,</span> <span class="n">val_known_indices</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_val_split_fraction</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">train_labels</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">train_val_rng</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span>  <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested train size + validation size (</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span><span class="si">}</span><span class="s2">) is larger than the number of available train samples (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested train size (</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span><span class="si">}</span><span class="s2">) is larger than the number of available train samples (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span> <span class="ow">and</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requested validation size (</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span><span class="si">}</span><span class="s2">) is larger than the number of available train samples (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_indices</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                    <span class="n">train_indices</span><span class="p">,</span> <span class="n">val_known_indices</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_indices</span><span class="p">,</span>
                                                                        <span class="n">train_size</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">train_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                                                        <span class="n">test_size</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span> <span class="o">!=</span> <span class="s2">&quot;all&quot;</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                                                                        <span class="n">stratify</span><span class="o">=</span><span class="n">train_labels</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">train_val_rng</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">val_known_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="n">val_unknown_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="n">val_data_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Initialize test set</span>
        <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">need_test_set</span><span class="p">:</span>
            <span class="n">test_known_indices</span><span class="p">,</span> <span class="n">test_unknown_indices</span><span class="p">,</span> <span class="n">test_data_path</span> <span class="o">=</span> <span class="n">init_or_load_test_indices</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">,</span>
                                                                                                 <span class="n">known_apps</span><span class="o">=</span><span class="n">known_apps</span><span class="p">,</span>
                                                                                                 <span class="n">unknown_apps</span><span class="o">=</span><span class="n">unknown_apps</span><span class="p">,</span>
                                                                                                 <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                                                                                                 <span class="n">disable_indices_cache</span><span class="o">=</span><span class="n">disable_indices_cache</span><span class="p">,)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">test_known_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="n">test_unknown_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="n">test_data_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Fit scalers if needed</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">ppi_transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">ppi_transform</span><span class="o">.</span><span class="n">needs_fitting</span> <span class="ow">or</span>
            <span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_transform</span><span class="o">.</span><span class="n">needs_fitting</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">need_train_set</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Train set is needed to fit the scalers. Provide pre-fitted scalers.&quot;</span><span class="p">)</span>
            <span class="n">fit_scalers</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">,</span> <span class="n">train_indices</span><span class="o">=</span><span class="n">train_indices</span><span class="p">)</span>
        <span class="c1"># Subset dataset indices based on the selected sizes and compute application counts</span>
        <span class="n">dataset_indices</span> <span class="o">=</span> <span class="n">IndicesTuple</span><span class="p">(</span><span class="n">train_indices</span><span class="o">=</span><span class="n">train_indices</span><span class="p">,</span> <span class="n">val_known_indices</span><span class="o">=</span><span class="n">val_known_indices</span><span class="p">,</span> <span class="n">val_unknown_indices</span><span class="o">=</span><span class="n">val_unknown_indices</span><span class="p">,</span> <span class="n">test_known_indices</span><span class="o">=</span><span class="n">test_known_indices</span><span class="p">,</span> <span class="n">test_unknown_indices</span><span class="o">=</span><span class="n">test_unknown_indices</span><span class="p">)</span>
        <span class="n">dataset_indices</span> <span class="o">=</span> <span class="n">subset_and_sort_indices</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">,</span> <span class="n">dataset_indices</span><span class="o">=</span><span class="n">dataset_indices</span><span class="p">)</span>
        <span class="n">known_app_counts</span> <span class="o">=</span> <span class="n">compute_known_app_counts</span><span class="p">(</span><span class="n">dataset_indices</span><span class="o">=</span><span class="n">dataset_indices</span><span class="p">,</span> <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">)</span>
        <span class="n">unknown_app_counts</span> <span class="o">=</span> <span class="n">compute_unknown_app_counts</span><span class="p">(</span><span class="n">dataset_indices</span><span class="o">=</span><span class="n">dataset_indices</span><span class="p">,</span> <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">)</span>
        <span class="c1"># Combine known and unknown test indicies to create a single dataloader</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_unknown_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">test_unknown_size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">unknown_apps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test_combined_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">dataset_indices</span><span class="o">.</span><span class="n">test_known_indices</span><span class="p">,</span> <span class="n">dataset_indices</span><span class="o">.</span><span class="n">test_unknown_indices</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">test_combined_indices</span> <span class="o">=</span> <span class="n">dataset_indices</span><span class="o">.</span><span class="n">test_known_indices</span>
        <span class="c1"># Create encoder the class info structure</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">known_apps</span><span class="p">)</span>
        <span class="n">encoder</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">UNKNOWN_STR_LABEL</span><span class="p">)</span>
        <span class="n">class_info</span> <span class="o">=</span> <span class="n">create_class_info</span><span class="p">(</span><span class="n">servicemap</span><span class="o">=</span><span class="n">servicemap</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span> <span class="n">known_apps</span><span class="o">=</span><span class="n">known_apps</span><span class="p">,</span> <span class="n">unknown_apps</span><span class="o">=</span><span class="n">unknown_apps</span><span class="p">)</span>
        <span class="n">encode_labels_with_unknown_fn</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_encode_labels_with_unknown</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span> <span class="n">class_info</span><span class="o">=</span><span class="n">class_info</span><span class="p">)</span>
        <span class="c1"># Create train, validation, and test datasets</span>
        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">val_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">need_train_set</span><span class="p">:</span>
            <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">PyTablesDataset</span><span class="p">(</span>
                <span class="n">database_path</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">database_path</span><span class="p">,</span>
                <span class="n">tables_paths</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">_get_train_tables_paths</span><span class="p">(),</span>
                <span class="n">indices</span><span class="o">=</span><span class="n">dataset_indices</span><span class="o">.</span><span class="n">train_indices</span><span class="p">,</span>
                <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                <span class="n">tables_cat_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_cat_enum</span><span class="p">,</span>
                <span class="n">flowstats_features</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features</span><span class="p">,</span>
                <span class="n">flowstats_features_boolean</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features_boolean</span><span class="p">,</span>
                <span class="n">flowstats_features_phist</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features_phist</span><span class="p">,</span>
                <span class="n">other_fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">other_fields</span><span class="p">,</span>
                <span class="n">ppi_channels</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_ppi_channels</span><span class="p">(),</span>
                <span class="n">ppi_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">ppi_transform</span><span class="p">,</span>
                <span class="n">flowstats_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_transform</span><span class="p">,</span>
                <span class="n">flowstats_phist_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_phist_transform</span><span class="p">,</span>
                <span class="n">target_transform</span><span class="o">=</span><span class="n">encode_labels_with_unknown_fn</span><span class="p">,</span>
                <span class="n">return_tensors</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">return_tensors</span><span class="p">,)</span>
        <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">need_val_set</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">val_data_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">val_dataset</span> <span class="o">=</span> <span class="n">PyTablesDataset</span><span class="p">(</span>
                <span class="n">database_path</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">database_path</span><span class="p">,</span>
                <span class="n">tables_paths</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">_get_train_tables_paths</span><span class="p">(),</span>
                <span class="n">indices</span><span class="o">=</span><span class="n">dataset_indices</span><span class="o">.</span><span class="n">val_known_indices</span><span class="p">,</span>
                <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                <span class="n">tables_cat_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_cat_enum</span><span class="p">,</span>
                <span class="n">flowstats_features</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features</span><span class="p">,</span>
                <span class="n">flowstats_features_boolean</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features_boolean</span><span class="p">,</span>
                <span class="n">flowstats_features_phist</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features_phist</span><span class="p">,</span>
                <span class="n">other_fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">other_fields</span><span class="p">,</span>
                <span class="n">ppi_channels</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_ppi_channels</span><span class="p">(),</span>
                <span class="n">ppi_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">ppi_transform</span><span class="p">,</span>
                <span class="n">flowstats_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_transform</span><span class="p">,</span>
                <span class="n">flowstats_phist_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_phist_transform</span><span class="p">,</span>
                <span class="n">target_transform</span><span class="o">=</span><span class="n">encode_labels_with_unknown_fn</span><span class="p">,</span>
                <span class="n">return_tensors</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">return_tensors</span><span class="p">,</span>
                <span class="n">preload</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">preload_val</span><span class="p">,</span>
                <span class="n">preload_blob</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">val_data_path</span><span class="p">,</span> <span class="s2">&quot;preload&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;val_dataset-</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_known_size</span><span class="si">}</span><span class="s2">.npz&quot;</span><span class="p">),)</span>
        <span class="k">if</span> <span class="n">dataset_config</span><span class="o">.</span><span class="n">need_test_set</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">test_data_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">PyTablesDataset</span><span class="p">(</span>
                <span class="n">database_path</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">database_path</span><span class="p">,</span>
                <span class="n">tables_paths</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">_get_test_tables_paths</span><span class="p">(),</span>
                <span class="n">indices</span><span class="o">=</span><span class="n">test_combined_indices</span><span class="p">,</span>
                <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                <span class="n">tables_cat_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_cat_enum</span><span class="p">,</span>
                <span class="n">flowstats_features</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features</span><span class="p">,</span>
                <span class="n">flowstats_features_boolean</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features_boolean</span><span class="p">,</span>
                <span class="n">flowstats_features_phist</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_features_phist</span><span class="p">,</span>
                <span class="n">other_fields</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">other_fields</span><span class="p">,</span>
                <span class="n">ppi_channels</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_ppi_channels</span><span class="p">(),</span>
                <span class="n">ppi_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">ppi_transform</span><span class="p">,</span>
                <span class="n">flowstats_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_transform</span><span class="p">,</span>
                <span class="n">flowstats_phist_transform</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">flowstats_phist_transform</span><span class="p">,</span>
                <span class="n">target_transform</span><span class="o">=</span><span class="n">encode_labels_with_unknown_fn</span><span class="p">,</span>
                <span class="n">return_tensors</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">return_tensors</span><span class="p">,</span>
                <span class="n">preload</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">preload_test</span><span class="p">,</span>
                <span class="n">preload_blob</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_data_path</span><span class="p">,</span> <span class="s2">&quot;preload&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;test_dataset-</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_known_size</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_unknown_size</span><span class="si">}</span><span class="s2">.npz&quot;</span><span class="p">),)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="o">=</span> <span class="n">class_info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_indices</span> <span class="o">=</span> <span class="n">dataset_indices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span> <span class="o">=</span> <span class="n">val_dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">known_app_counts</span> <span class="o">=</span> <span class="n">known_app_counts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unknown_app_counts</span> <span class="o">=</span> <span class="n">unknown_app_counts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span> <span class="o">=</span> <span class="n">collate_fn_simple</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.set_dataset_config_and_initialize" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_dataset_config_and_initialize</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_dataset_config_and_initialize</span><span class="p">(</span>
    <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span>
    <span class="n">disable_indices_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Initialize train, validation, and test sets. Data cannot be accessed before calling this method.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dataset_config</code></td>
          <td>
                <code><span title="cesnet_datazoo.config.DatasetConfig">DatasetConfig</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Desired configuration of the dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>disable_indices_cache</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to disable caching of the dataset indices. This is useful when the dataset is used in many different configurations and you want to save disk space.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_dataset_config_and_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">:</span> <span class="n">DatasetConfig</span><span class="p">,</span> <span class="n">disable_indices_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize train, validation, and test sets. Data cannot be accessed before calling this method.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        dataset_config: Desired configuration of the dataset.</span>
<span class="sd">        disable_indices_cache: Whether to disable caching of the dataset indices. This is useful when the dataset is used in many different configurations and you want to save disk space.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="o">=</span> <span class="n">dataset_config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_train_val_test</span><span class="p">(</span><span class="n">disable_indices_cache</span><span class="o">=</span><span class="n">disable_indices_cache</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_train_dataloader" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_train_dataloader</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_train_dataloader</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Provides a PyTorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> for training. The dataloader is created on the first call and then cached.
When the dataloader is iterated in random order, the last incomplete batch is dropped.
The dataloader is configured with the following config attributes:</p>
<table>
<thead>
<tr>
<th>Dataset config</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>batch_size</code></td>
<td>Number of samples per batch.</td>
</tr>
<tr>
<td><code>train_workers</code></td>
<td>Number of workers for loading train data.</td>
</tr>
<tr>
<td><code>train_dataloader_order</code></td>
<td>Whether to load train data in sequential or random order. See <a class="autorefs autorefs-internal" href="../reference_dataset_config/#config.DataLoaderOrder">config.DataLoaderOrder</a>.</td>
</tr>
<tr>
<td><code>train_dataloader_seed</code></td>
<td>Seed for loading train data in random order.</td>
</tr>
</tbody>
</table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Train data as an iterable dataloader. See <a class="autorefs autorefs-internal" href="../dataloaders/#using-dataloaders">using dataloaders</a> for more details.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_train_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for training. The dataloader is created on the first call and then cached.</span>
<span class="sd">    When the dataloader is iterated in random order, the last incomplete batch is dropped.</span>
<span class="sd">    The dataloader is configured with the following config attributes:</span>

<span class="sd">    | Dataset config               | Description                                                                                |</span>
<span class="sd">    | ---------------------------- | ------------------------------------------------------------------------------------------ |</span>
<span class="sd">    | `batch_size`                 | Number of samples per batch.                                                               |</span>
<span class="sd">    | `train_workers`              | Number of workers for loading train data.                                                  |</span>
<span class="sd">    | `train_dataloader_order`     | Whether to load train data in sequential or random order. See [config.DataLoaderOrder][].  |</span>
<span class="sd">    | `train_dataloader_seed`      | Seed for loading train data in random order.                                               |</span>

<span class="sd">    Returns:</span>
<span class="sd">        Train data as an iterable dataloader. See [using dataloaders][using-dataloaders] for more details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting train dataloader&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_train_set</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Train dataloader is not available when need_train_set is false&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span>
    <span class="c1"># Create sampler according to the selected order</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_order</span> <span class="o">==</span> <span class="n">DataLoaderOrder</span><span class="o">.</span><span class="n">RANDOM</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Generator</span><span class="p">()</span>
            <span class="n">generator</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_seed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span> <span class="o">=</span> <span class="n">RandomSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="n">generator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_order</span> <span class="o">==</span> <span class="n">DataLoaderOrder</span><span class="o">.</span><span class="n">SEQUENTIAL</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span> <span class="o">=</span> <span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">assert_never</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_dataloader_order</span><span class="p">)</span>
    <span class="c1"># Create dataloader</span>
    <span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">BatchSampler</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span><span class="p">)</span>
    <span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_workers</span><span class="p">,</span>
        <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_fn</span><span class="p">,</span>
        <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span><span class="p">,</span>
        <span class="n">persistent_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_workers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sampler</span><span class="o">=</span><span class="n">batch_sampler</span><span class="p">,)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">train_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">pytables_worker_init</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">train_dataloader</span>
    <span class="k">return</span> <span class="n">train_dataloader</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_val_dataloader" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_val_dataloader</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_val_dataloader</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Provides a PyTorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> for validation.
The dataloader is created on the first call and then cached.
The dataloader is configured with the following config attributes:</p>
<table>
<thead>
<tr>
<th>Dataset config</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>test_batch_size</code></td>
<td>Number of samples per batch for loading validation and test data.</td>
</tr>
<tr>
<td><code>val_workers</code></td>
<td>Number of workers for loading validation data.</td>
</tr>
</tbody>
</table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Validation data as an iterable dataloader. See <a class="autorefs autorefs-internal" href="../dataloaders/#using-dataloaders">using dataloaders</a> for more details.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_val_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for validation.</span>
<span class="sd">    The dataloader is created on the first call and then cached.</span>
<span class="sd">    The dataloader is configured with the following config attributes:</span>

<span class="sd">    | Dataset config    | Description                                                       |</span>
<span class="sd">    | ------------------| ------------------------------------------------------------------|</span>
<span class="sd">    | `test_batch_size` | Number of samples per batch for loading validation and test data. |</span>
<span class="sd">    | `val_workers`     | Number of workers for loading validation data.                    |</span>

<span class="sd">    Returns:</span>
<span class="sd">        Validation data as an iterable dataloader. See [using dataloaders][using-dataloaders] for more details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting validaion dataloader&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_val_set</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Validation dataloader is not available when need_val_set is false&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span>
    <span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">BatchSampler</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_batch_size</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_workers</span><span class="p">,</span>
        <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_fn</span><span class="p">,</span>
        <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span><span class="p">,</span>
        <span class="n">persistent_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_workers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sampler</span><span class="o">=</span><span class="n">batch_sampler</span><span class="p">,)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">val_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="o">.</span><span class="n">pytables_worker_init</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">val_dataloader</span>
    <span class="k">return</span> <span class="n">val_dataloader</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_test_dataloader" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_test_dataloader</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_test_dataloader</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Provides a PyTorch <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> for testing.
The dataloader is created on the first call and then cached.</p>
<p>When the dataset is used in the open-world setting, and unknown classes are defined,
the test dataloader returns <code>test_known_size</code> samples of known classes followed by <code>test_unknown_size</code> samples of unknown classes.</p>
<p>The dataloader is configured with the following config attributes:</p>
<table>
<thead>
<tr>
<th>Dataset config</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>test_batch_size</code></td>
<td>Number of samples per batch for loading validation and test data.</td>
</tr>
<tr>
<td><code>test_workers</code></td>
<td>Number of workers for loading test data.</td>
</tr>
</tbody>
</table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Test data as an iterable dataloader. See <a class="autorefs autorefs-internal" href="../dataloaders/#using-dataloaders">using dataloaders</a> for more details.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_test_dataloader</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a PyTorch [`DataLoader`](https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader) for testing.</span>
<span class="sd">    The dataloader is created on the first call and then cached.</span>

<span class="sd">    When the dataset is used in the open-world setting, and unknown classes are defined,</span>
<span class="sd">    the test dataloader returns `test_known_size` samples of known classes followed by `test_unknown_size` samples of unknown classes.</span>

<span class="sd">    The dataloader is configured with the following config attributes:</span>

<span class="sd">    | Dataset config    | Description                                                       |</span>
<span class="sd">    | ------------------| ------------------------------------------------------------------|</span>
<span class="sd">    | `test_batch_size` | Number of samples per batch for loading validation and test data. |</span>
<span class="sd">    | `test_workers`    | Number of workers for loading test data.                          |</span>

<span class="sd">    Returns:</span>
<span class="sd">        Test data as an iterable dataloader. See [using dataloaders][using-dataloaders] for more details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting test dataloader&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">need_test_set</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Test dataloader is not available when need_test_set is false&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span>
    <span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">BatchSampler</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_batch_size</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_workers</span><span class="p">,</span>
        <span class="n">worker_init_fn</span><span class="o">=</span><span class="n">worker_init_fn</span><span class="p">,</span>
        <span class="n">collate_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collate_fn</span><span class="p">,</span>
        <span class="n">persistent_workers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sampler</span><span class="o">=</span><span class="n">batch_sampler</span><span class="p">,)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">test_workers</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="o">.</span><span class="n">pytables_worker_init</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">test_dataloader</span>
    <span class="k">return</span> <span class="n">test_dataloader</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_dataloaders" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_dataloaders</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_dataloaders</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
    <span class="nb">tuple</span><span class="p">[</span><span class="n">DataLoader</span><span class="p">,</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">DataLoader</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Gets train, validation, and test dataloaders in one call.</p>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_dataloaders</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">DataLoader</span><span class="p">,</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">DataLoader</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets train, validation, and test dataloaders in one call.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting dataloaders&quot;</span><span class="p">)</span>
    <span class="n">train_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_train_dataloader</span><span class="p">()</span>
    <span class="n">val_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_val_dataloader</span><span class="p">()</span>
    <span class="n">test_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_test_dataloader</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">train_dataloader</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="p">,</span> <span class="n">test_dataloader</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_train_df" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_train_df</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_train_df</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Creates a train Pandas <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html"><code>DataFrame</code></a>. The dataframe is in sequential (datetime) order. Consider shuffling the dataframe if needed.</p>
<div class="admonition warning">
<p class="admonition-title">Memory usage</p>
<p>The whole train set is loaded into memory. If the dataset size is larger than <code>'S'</code>, consider using <code>get_train_dataloader</code> instead.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>flatten_ppi</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to flatten the PPI sequence into individual columns (named <code>IPT_X</code>, <code>DIR_X</code>, <code>SIZE_X</code>, <code>PUSH_X</code>, <em>X</em> being the index of the packet) or keep one <code>PPI</code> column with 2D data.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Train data as a dataframe.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_train_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a train Pandas [`DataFrame`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html). The dataframe is in sequential (datetime) order. Consider shuffling the dataframe if needed.</span>

<span class="sd">    !!! warning &quot;Memory usage&quot;</span>

<span class="sd">        The whole train set is loaded into memory. If the dataset size is larger than `&#39;S&#39;`, consider using `get_train_dataloader` instead.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        flatten_ppi: Whether to flatten the PPI sequence into individual columns (named `IPT_X`, `DIR_X`, `SIZE_X`, `PUSH_X`, *X* being the index of the packet) or keep one `PPI` column with 2D data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Train data as a dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_before_dataframe</span><span class="p">(</span><span class="n">check_train</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DATAFRAME_SAMPLES_WARNING_THRESHOLD</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Train set has (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples), consider using get_train_dataloader() instead&quot;</span><span class="p">)</span>
    <span class="n">train_dataloader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_train_dataloader</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="p">,</span> <span class="n">BatchSampler</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="c1"># Read dataloader in sequential order</span>
    <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sampler</span> <span class="o">=</span> <span class="n">SequentialSampler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_dataset</span><span class="p">)</span>
    <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">drop_last</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">create_df_from_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
                                   <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
                                   <span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">,</span>
                                   <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>
    <span class="c1"># Restore the original dataloader sampler and drop_last</span>
    <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">sampler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_sampler</span>
    <span class="n">train_dataloader</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">drop_last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader_drop_last</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_val_df" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_val_df</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_val_df</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Creates validation Pandas <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html"><code>DataFrame</code></a>. The dataframe is in sequential (datetime) order.</p>
<div class="admonition warning">
<p class="admonition-title">Memory usage</p>
<p>The whole validation set is loaded into memory. If the dataset size is larger than <code>'S'</code>, consider using <code>get_val_dataloader</code> instead.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>flatten_ppi</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to flatten the PPI sequence into individual columns (named <code>IPT_X</code>, <code>DIR_X</code>, <code>SIZE_X</code>, <code>PUSH_X</code>, <em>X</em> being the index of the packet) or keep one <code>PPI</code> column with 2D data.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Validation data as a dataframe.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_val_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates validation Pandas [`DataFrame`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html). The dataframe is in sequential (datetime) order.</span>

<span class="sd">    !!! warning &quot;Memory usage&quot;</span>

<span class="sd">        The whole validation set is loaded into memory. If the dataset size is larger than `&#39;S&#39;`, consider using `get_val_dataloader` instead.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        flatten_ppi: Whether to flatten the PPI sequence into individual columns (named `IPT_X`, `DIR_X`, `SIZE_X`, `PUSH_X`, *X* being the index of the packet) or keep one `PPI` column with 2D data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Validation data as a dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_before_dataframe</span><span class="p">(</span><span class="n">check_val</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DATAFRAME_SAMPLES_WARNING_THRESHOLD</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation set has (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples), consider using get_val_dataloader() instead&quot;</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">create_df_from_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_val_dataloader</span><span class="p">(),</span>
                                     <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
                                     <span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">,</span>
                                     <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_test_df" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_test_df</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_test_df</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Creates test Pandas <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html"><code>DataFrame</code></a>. The dataframe is in sequential (datetime) order.</p>
<p>When the dataset is used in the open-world setting, and unknown classes are defined,
the returned test dataframe is composed of <code>test_known_size</code> samples of known classes followed by <code>test_unknown_size</code> samples of unknown classes.</p>
<div class="admonition warning">
<p class="admonition-title">Memory usage</p>
<p>The whole test set is loaded into memory. If the dataset size is larger than <code>'S'</code>, consider using <code>get_test_dataloader</code> instead.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>flatten_ppi</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to flatten the PPI sequence into individual columns (named <code>IPT_X</code>, <code>DIR_X</code>, <code>SIZE_X</code>, <code>PUSH_X</code>, <em>X</em> being the index of the packet) or keep one <code>PPI</code> column with 2D data.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Test data as a dataframe.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_test_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flatten_ppi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates test Pandas [`DataFrame`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html). The dataframe is in sequential (datetime) order.</span>


<span class="sd">    When the dataset is used in the open-world setting, and unknown classes are defined,</span>
<span class="sd">    the returned test dataframe is composed of `test_known_size` samples of known classes followed by `test_unknown_size` samples of unknown classes.</span>


<span class="sd">    !!! warning &quot;Memory usage&quot;</span>

<span class="sd">        The whole test set is loaded into memory. If the dataset size is larger than `&#39;S&#39;`, consider using `get_test_dataloader` instead.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        flatten_ppi: Whether to flatten the PPI sequence into individual columns (named `IPT_X`, `DIR_X`, `SIZE_X`, `PUSH_X`, *X* being the index of the packet) or keep one `PPI` column with 2D data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Test data as a dataframe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_before_dataframe</span><span class="p">(</span><span class="n">check_test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">DATAFRAME_SAMPLES_WARNING_THRESHOLD</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test set has (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples), consider using get_test_dataloader() instead&quot;</span><span class="p">)</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">(</span><span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">create_df_from_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_test_dataloader</span><span class="p">(),</span>
                                     <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
                                     <span class="n">flatten_ppi</span><span class="o">=</span><span class="n">flatten_ppi</span><span class="p">,</span>
                                     <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_num_classes" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_num_classes</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_num_classes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the number of classes in the current configuration of the dataset.</p>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_num_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the number of classes in the current configuration of the dataset.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting the number of classes&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span><span class="o">.</span><span class="n">num_classes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_known_apps" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_known_apps</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_known_apps</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the list of known applications in the current configuration of the dataset.</p>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_known_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the list of known applications in the current configuration of the dataset.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting known apps&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span><span class="o">.</span><span class="n">known_apps</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.get_unknown_apps" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_unknown_apps</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_unknown_apps</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the list of unknown applications in the current configuration of the dataset.</p>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_unknown_apps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the list of unknown applications in the current configuration of the dataset.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dataset is not initialized, use set_dataset_config_and_initialize() before getting unknown apps&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_info</span><span class="o">.</span><span class="n">unknown_apps</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="datasets.cesnet_dataset.CesnetDataset.compute_dataset_statistics" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compute_dataset_statistics</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">compute_dataset_statistics</span><span class="p">(</span>
    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10000000</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16384</span><span class="p">,</span>
    <span class="n">disabled_apps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Computes dataset statistics and saves them to the <code>statistics_path</code> folder.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_samples</code></td>
          <td>
                <code>int | <span title="typing.Literal">Literal</span>[&#39;all&#39;]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of samples to use for computing the statistics.</p>
            </div>
          </td>
          <td>
                <code>10000000</code>
          </td>
        </tr>
        <tr>
          <td><code>num_workers</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of workers for loading data.</p>
            </div>
          </td>
          <td>
                <code>4</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of samples per batch for loading data.</p>
            </div>
          </td>
          <td>
                <code>16384</code>
          </td>
        </tr>
        <tr>
          <td><code>disabled_apps</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[list[str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of applications to exclude from the statistics.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>cesnet_datazoo\datasets\cesnet_dataset.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_dataset_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10_000_000</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16384</span><span class="p">,</span> <span class="n">disabled_apps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes dataset statistics and saves them to the `statistics_path` folder.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        num_samples: Number of samples to use for computing the statistics.</span>
<span class="sd">        num_workers: Number of workers for loading data.</span>
<span class="sd">        batch_size: Number of samples per batch for loading data.</span>
<span class="sd">        disabled_apps: List of applications to exclude from the statistics.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">disabled_apps</span><span class="p">:</span>
        <span class="n">bad_disabled_apps</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">disabled_apps</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_classes</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bad_disabled_apps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad applications in disabled_apps </span><span class="si">{</span><span class="n">bad_disabled_apps</span><span class="si">}</span><span class="s2">. Use applications available in dataset.available_classes&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">statistics_path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">statistics_path</span><span class="p">)</span>
    <span class="n">compute_dataset_statistics</span><span class="p">(</span><span class="n">database_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">database_path</span><span class="p">,</span>
                               <span class="n">tables_app_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_app_enum</span><span class="p">,</span>
                               <span class="n">tables_cat_enum</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tables_cat_enum</span><span class="p">,</span>
                               <span class="n">output_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">statistics_path</span><span class="p">,</span>
                               <span class="n">packet_histograms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">packet_histograms</span><span class="p">,</span>
                               <span class="n">flowstats_features_boolean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">flowstats_features_boolean</span><span class="p">,</span>
                               <span class="n">protocol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">protocol</span><span class="p">,</span>
                               <span class="n">extra_fields</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;CESNET-TLS22&quot;</span><span class="p">),</span>
                               <span class="n">disabled_apps</span><span class="o">=</span><span class="n">disabled_apps</span> <span class="k">if</span> <span class="n">disabled_apps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
                               <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span>
                               <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
                               <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                               <span class="n">silent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.94c44541.min.js"></script>
      
    
  </body>
</html>